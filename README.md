# Отчёт по проекту: Регрессионная модель с инференсом и Streamlit-приложением

## 1. Краткое описание проделанной работы

### Этап 1. Исследовательский анализ данных (EDA)
На первом этапе был выполнен исследовательский анализ данных. Были изучены структура датасета, типы признаков, наличие пропусков и выбросов. Для числовых признаков построены гистограммы и boxplot, рассчитаны корреляции между признаками и целевой переменной. Это позволило выявить наиболее информативные признаки и потенциальные проблемы в данных (асимметрия распределений, выбросы).

### Этап 2. Подготовка данных
Данные были очищены и приведены к формату, пригодному для обучения моделей. Категориальные признаки закодированы с помощью One-Hot Encoding, числовые признаки масштабированы. Выполнено разделение данных на обучающую и тестовую выборки для корректной оценки качества моделей.

### Этап 3. Обучение и сравнение моделей
Были обучены следующие модели:
- Linear Regression;
- Lasso;
- ElasticNet;
- Ridge.

Для моделей с регуляризацией выполнен подбор гиперпараметров с использованием GridSearchCV. Качество моделей оценивалось на обучающей и тестовой выборках с помощью метрик R² и MSE.

### Этап 4. Реализация бизнес-метрик
Помимо стандартных метрик качества была реализована кастомная бизнес-метрика, отражающая долю прогнозов с относительной ошибкой не более 10%. Также была предложена расширенная версия метрики с повышенным штрафом за недопрогноз, так как согласно бизнес-требованиям недопрогноз считается более критичным, чем перепрогноз.

### Этап 5. Разработка Streamlit-приложения
Было разработано интерактивное приложение на Streamlit, включающее:
- визуализацию основных графиков в рамках EDA;
- инференс обученной модели по CSV-файлу и по ручному вводу признаков;
- визуализацию весов обученной модели с возможностью выбора Top-K признаков.

Приложение задеплоено в Streamlit Cloud.

## 2. Полученные результаты и их интерпретация

### Качество моделей
- Linear Regression: R² ≈ 0.60;
- Lasso, ElasticNet, Ridge (после подбора гиперпараметров): сопоставимые значения R²;
- значения R² на train и test близки, что указывает на отсутствие сильного переобучения.

### Интерпретация
Модели объясняют около 60% дисперсии целевой переменной, что является приемлемым результатом для линейных моделей на реальных данных. Регуляризация повышает устойчивость моделей и улучшает результаты по бизнес-метрике.

## 3. Факторы, давшие наибольший прирост качества

Наибольший вклад в качество модели внесли:
- корректная предобработка данных (масштабирование и One-Hot Encoding);
- использование регуляризованных моделей;
- подбор гиперпараметров;
- применение бизнес-ориентированной метрики вместо только стандартных статистических метрик.

## 4. Нереализованные аспекты и ограничения

Не удалось добиться значительного прироста качества по метрике R² по сравнению с базовой линейной моделью. Это связано с линейной природой используемых моделей, которые не способны захватывать сложные нелинейные зависимости в данных. Более сложные модели не рассматривались в рамках данной работы, так как основной акцент был сделан на интерпретируемость и анализ линейных методов.

## 5. Оценка разработанного сервиса

### Удобство использования
Приложение обладает интуитивно понятным интерфейсом: пользователь может выбрать модель, загрузить данные или ввести признаки вручную и получить прогноз.

### Качество визуализаций
Хорошо визуализируются распределения признаков, выбросы и веса модели. Визуализация коэффициентов позволяет интерпретировать вклад отдельных признаков в прогноз.

### Ограничения
- при большом числе признаков визуализация всех весов одновременно становится менее наглядной;
- отсутствует автоматическая проверка структуры входных CSV-файлов.

### Возможные улучшения
В следующих итерациях проекта планируется:
- добавить валидацию входных данных;
- поддержать более сложные модели;
- расширить визуализации (например, SHAP values);
- улучшить обработку пользовательских ошибок.

## 6. Ссылка на приложение
Приложение развернуто в Streamlit Cloud и доступно по ссылке:

**https://app-regression-app-klfwerythesr4xowtu8vik.streamlit.app/**
